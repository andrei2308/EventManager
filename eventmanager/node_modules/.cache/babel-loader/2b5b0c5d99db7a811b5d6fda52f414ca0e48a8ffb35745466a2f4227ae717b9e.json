{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nexports.__esModule = true;\nvar ts_log_1 = require(\"ts-log\");\nvar OpenAPIRequestCoercer = /** @class */function () {\n  function OpenAPIRequestCoercer(args) {\n    var loggingKey = args && args.loggingKey ? \"\".concat(args.loggingKey, \": \") : '';\n    if (!args) {\n      throw new Error(\"\".concat(loggingKey, \"missing args argument\"));\n    }\n    var logger = args.logger || ts_log_1.dummyLogger;\n    if (!Array.isArray(args.parameters)) {\n      throw new Error(\"\".concat(loggingKey, \"args.parameters must be an Array\"));\n    }\n    if (!args.coercionStrategy) {\n      args.coercionStrategy = {};\n    }\n    var extensionBase = args && args.extensionBase ? args.extensionBase : 'x-openapi-coercion';\n    var strictExtensionName = \"\".concat(extensionBase, \"-strict\");\n    var enableObjectCoercion = !!args.enableObjectCoercion;\n    this.coerceHeaders = buildCoercer({\n      params: args.parameters,\n      property: 'header',\n      isHeaders: true,\n      logger: logger,\n      loggingKey: loggingKey,\n      strictExtensionName: strictExtensionName,\n      enableObjectCoercion: enableObjectCoercion,\n      coercionStrategy: args.coercionStrategy\n    });\n    this.coerceParams = buildCoercer({\n      params: args.parameters,\n      property: 'path',\n      isHeaders: false,\n      logger: logger,\n      loggingKey: loggingKey,\n      strictExtensionName: strictExtensionName,\n      enableObjectCoercion: enableObjectCoercion,\n      coercionStrategy: args.coercionStrategy\n    });\n    this.coerceQuery = buildCoercer({\n      params: args.parameters,\n      property: 'query',\n      isHeaders: false,\n      logger: logger,\n      loggingKey: loggingKey,\n      strictExtensionName: strictExtensionName,\n      enableObjectCoercion: enableObjectCoercion,\n      coercionStrategy: args.coercionStrategy\n    });\n    this.coerceFormData = buildCoercer({\n      params: args.parameters,\n      requestBody: args.requestBody,\n      property: 'formData',\n      isHeaders: false,\n      logger: logger,\n      loggingKey: loggingKey,\n      strictExtensionName: strictExtensionName,\n      enableObjectCoercion: enableObjectCoercion,\n      coercionStrategy: args.coercionStrategy\n    });\n  }\n  OpenAPIRequestCoercer.prototype.coerce = function (request) {\n    if (request.headers && this.coerceHeaders) {\n      this.coerceHeaders(request.headers);\n    }\n    if (request.params && this.coerceParams) {\n      this.coerceParams(request.params);\n    }\n    if (request.query && this.coerceQuery) {\n      this.coerceQuery(request.query);\n    }\n    if (request.body && this.coerceFormData) {\n      this.coerceFormData(request.body);\n    }\n  };\n  return OpenAPIRequestCoercer;\n}();\nexports[\"default\"] = OpenAPIRequestCoercer;\nfunction buildCoercer(args) {\n  var _a, _b, _c;\n  if (!args.params.length && !args.requestBody) {\n    return;\n  }\n  var l = args.isHeaders ? function (name) {\n    return name.toLowerCase();\n  } : function (name) {\n    return name;\n  };\n  var properties = args.params.filter(byLocation(args.property));\n  if (args.property === 'formData' && args.requestBody) {\n    var openapiv3formData_1 = (_c = (_b = (_a = args.requestBody) === null || _a === void 0 ? void 0 : _a.content['application/x-www-form-urlencoded']) === null || _b === void 0 ? void 0 : _b.schema) === null || _c === void 0 ? void 0 : _c.properties;\n    if (openapiv3formData_1) {\n      properties = properties.concat(Object.keys(openapiv3formData_1).map(function (k) {\n        return __assign(__assign({}, openapiv3formData_1[k]), {\n          name: k\n        });\n      }));\n    }\n  }\n  var coercers = properties.reduce(function (acc, param) {\n    acc[l(param.name)] = buildCoercerForParam(args, param);\n    return acc;\n  }, {});\n  return function (obj) {\n    for (var paramName in obj) {\n      if (coercers.hasOwnProperty(l(paramName))) {\n        obj[paramName] = coercers[l(paramName)](obj[paramName]);\n      }\n    }\n  };\n}\nfunction buildCoercerForParam(args, param) {\n  var logger = args.logger,\n    loggingKey = args.loggingKey,\n    enableObjectCoercion = args.enableObjectCoercion,\n    _a = args.coercionStrategy,\n    customStrategy = _a === void 0 ? {} : _a;\n  var strict = !!param[args.strictExtensionName];\n  function getCoercer(type) {\n    var OBJECT_FORMAT_COERCER = {\n      \"default\": function (schema, input) {\n        return JSON.parse(input);\n      },\n      deepObject: function (schema, input) {\n        for (var _i = 0, _a = Object.keys(input); _i < _a.length; _i++) {\n          var key = _a[_i];\n          var propertySchema = schema.properties ? schema.properties[key] : schema.additionalProperties;\n          if (propertySchema) {\n            input[key] = getCoercer(propertySchema.type)(propertySchema, input[key]);\n          }\n        }\n        return input;\n      }\n    };\n    var COERCION_STRATEGIES = {\n      array: function (schema, input) {\n        if (!Array.isArray(input)) {\n          var collectionFormat = param.collectionFormat;\n          // OpenAPI 3.0 has replaced collectionFormat with a style property\n          // https://swagger.io/docs/specification/serialization/\n          if (param.style) {\n            if (param.style === 'form' && param[\"in\"] === 'query') {\n              collectionFormat = param.explode ? 'multi' : 'csv';\n            } else if (param.style === 'simple' && (param[\"in\"] === 'path' || param[\"in\"] === 'header')) {\n              collectionFormat = 'csv';\n            } else if (param.style === 'spaceDelimited' && param[\"in\"] === 'query') {\n              collectionFormat = 'ssv';\n            } else if (param.style === 'pipeDelimited' && param[\"in\"] === 'query') {\n              collectionFormat = 'pipes';\n            }\n          }\n          var sep = pathsep(collectionFormat || 'csv');\n          input = input.split(sep);\n        }\n        return input.map(function (v, i) {\n          var itemSchema = schema.items.schema ? schema.items.schema : schema.items;\n          return getCoercer(itemSchema.type)(itemSchema, v);\n        });\n      },\n      object: function (schema, input) {\n        if (!enableObjectCoercion) {\n          return input;\n        }\n        // Similar to arrays, objects support formats. In OpenAPI 3.0, the format is called \"style\".\n        // Currently this coercer only automatically supports the deepObject style, and a simple\n        // JSON format, though the OpenAPI 3.0 specification defines many styles similar to arrays.\n        var style = param.style || schema.format;\n        var objectCoercer = OBJECT_FORMAT_COERCER[style] || OBJECT_FORMAT_COERCER[\"default\"];\n        return objectCoercer(schema, input);\n      },\n      boolean: function (schema, input) {\n        if (typeof input === 'boolean') {\n          return input;\n        }\n        if (input === 'false') {\n          return false;\n        } else {\n          return true;\n        }\n      },\n      integer: function (schema, input) {\n        var result = Math.floor(Number(input));\n        return isNaN(result) ? input : result;\n      },\n      number: function (schema, input) {\n        var result = Number(input);\n        return isNaN(result) ? input : result;\n      },\n      string: function (schema, input) {\n        return String(input);\n      }\n    };\n    var STRICT_COERCION_STRATEGIES = {\n      boolean: function (schema, input) {\n        if (typeof input === 'boolean') {\n          return input;\n        }\n        if (input.toLowerCase() === 'false') {\n          return false;\n        } else if (input.toLowerCase() === 'true') {\n          return true;\n        } else {\n          return null;\n        }\n      }\n    };\n    if (customStrategy[type] !== undefined) {\n      return function (schema, input) {\n        return customStrategy[type](input);\n      };\n    }\n    if (strict && STRICT_COERCION_STRATEGIES[type] !== undefined) {\n      return STRICT_COERCION_STRATEGIES[type];\n    }\n    if (COERCION_STRATEGIES[type] !== undefined) {\n      return COERCION_STRATEGIES[type];\n    }\n    var msg = type === undefined ? 'No type has been defined' : \"No proper coercion strategy has been found for type '\".concat(type, \"'\");\n    logger.warn(loggingKey, \"\".concat(msg, \". A default 'identity' strategy has been set.\"));\n    return function (schema, input) {\n      return input;\n    };\n  }\n  // OpenAPI (Swagger) 2.0 has type and format information as direct properties\n  // of the param object. OpenAPI 3.0 has type and format information in a\n  // schema object property. Use a schema value to normalize the change across\n  // both versions so coercer works properly.\n  var paramOrSchema = param.schema || param;\n  if (paramOrSchema.type === 'array') {\n    if (!paramOrSchema.items) {\n      throw new Error(\"\".concat(args.loggingKey, \"items is a required property with type array\"));\n    }\n    if (paramOrSchema.items.type === 'array' || paramOrSchema.items.schema && paramOrSchema.items.schema.type === 'array') {\n      throw new Error(\"\".concat(args.loggingKey, \"nested arrays are not allowed (items was of type array)\"));\n    }\n  }\n  return getCoercer(paramOrSchema.type).bind(null, paramOrSchema);\n}\nfunction byLocation(location) {\n  return function (param) {\n    return param[\"in\"] === location;\n  };\n}\nfunction pathsep(format) {\n  switch (format) {\n    case 'csv':\n      return ',';\n    case 'ssv':\n      return ' ';\n    case 'tsv':\n      return '\\t';\n    case 'pipes':\n      return '|';\n  }\n}","map":{"version":3,"names":["ts_log_1","require","OpenAPIRequestCoercer","args","loggingKey","concat","Error","logger","dummyLogger","Array","isArray","parameters","coercionStrategy","extensionBase","strictExtensionName","enableObjectCoercion","coerceHeaders","buildCoercer","params","property","isHeaders","coerceParams","coerceQuery","coerceFormData","requestBody","prototype","coerce","request","headers","query","body","length","l","name","toLowerCase","properties","filter","byLocation","openapiv3formData_1","_c","_b","_a","content","schema","Object","keys","map","k","__assign","coercers","reduce","acc","param","buildCoercerForParam","obj","paramName","hasOwnProperty","customStrategy","strict","getCoercer","type","OBJECT_FORMAT_COERCER","default","input","JSON","parse","deepObject","_i","key","propertySchema","additionalProperties","COERCION_STRATEGIES","array","collectionFormat","style","explode","sep","pathsep","split","v","i","itemSchema","items","object","format","objectCoercer","boolean","integer","result","Math","floor","Number","isNaN","number","string","String","STRICT_COERCION_STRATEGIES","undefined","msg","warn","paramOrSchema","bind","location"],"sources":["../index.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}