{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nexports.__esModule = true;\nvar OpenAPIDefaultSetter = /** @class */function () {\n  function OpenAPIDefaultSetter(args) {\n    var loggingKey = args && args.loggingKey ? args.loggingKey + ': ' : '';\n    if (!args) {\n      throw new Error(loggingKey + 'missing args argument');\n    }\n    if (!Array.isArray(args.parameters)) {\n      throw new Error(loggingKey + 'args.parameters must be an Array');\n    }\n    this.headersDefaults = getDefaults('header', args.parameters);\n    this.queryDefaults = getDefaults('query', args.parameters);\n  }\n  OpenAPIDefaultSetter.prototype.handle = function (request) {\n    if (request.headers && this.headersDefaults) {\n      setDefaults(request.headers, this.headersDefaults);\n    }\n    if (request.query && this.queryDefaults) {\n      setDefaults(request.query, this.queryDefaults);\n    }\n  };\n  return OpenAPIDefaultSetter;\n}();\nexports[\"default\"] = OpenAPIDefaultSetter;\nfunction byLocation(location) {\n  return function (param) {\n    return param[\"in\"] === location;\n  };\n}\nfunction hasSchema(obj) {\n  return 'schema' in obj;\n}\nfunction resolveDefaultValue(parameter) {\n  if ('default' in parameter) {\n    return parameter[\"default\"];\n  }\n  if (hasSchema(parameter)) {\n    return parameter.schema && parameter.schema[\"default\"];\n  }\n  return undefined;\n}\nfunction resolveName(parameter) {\n  if (parameter[\"in\"] === 'header') {\n    return parameter.name.toLowerCase();\n  }\n  return parameter.name;\n}\nfunction getDefaults(location, parameters) {\n  var defaults = parameters.filter(byLocation(location)).reduce(function (result, param) {\n    var _a;\n    var name = resolveName(param);\n    var defaultValue = resolveDefaultValue(param);\n    if (defaultValue === undefined) {\n      return result;\n    }\n    return __assign(__assign({}, result), (_a = {}, _a[name] = defaultValue, _a));\n  }, {});\n  return Object.keys(defaults).length ? defaults : undefined;\n}\nfunction setDefaults(obj, defaults) {\n  for (var name_1 in defaults) {\n    if (!(name_1 in obj)) {\n      obj[name_1] = defaults[name_1];\n    }\n  }\n}","map":{"version":3,"names":["OpenAPIDefaultSetter","args","loggingKey","Error","Array","isArray","parameters","headersDefaults","getDefaults","queryDefaults","prototype","handle","request","headers","setDefaults","query","byLocation","location","param","hasSchema","obj","resolveDefaultValue","parameter","schema","undefined","resolveName","name","toLowerCase","defaults","filter","reduce","result","defaultValue","__assign","_a","Object","keys","length","name_1"],"sources":["../index.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}